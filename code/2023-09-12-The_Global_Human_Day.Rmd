---
title: "The Global Human Day"
author: "Steven Turnbull"
date: "2023-09-12"

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R}
library(here)
library(tidyverse)
DATE <- "2023-09-12"
```

```{R}
#Load tables
FILES_LOC <- here('data','2023',DATE)
FILES <- list.files(FILES_LOC)
for(FILE in FILES){
  if(str_detect(FILE,".csv")){
    table_name  <-  str_replace_all(FILE,".csv","")
    assign(x =table_name,
           value = read.csv(paste0(FILES_LOC,"/",FILE))
           )
    print(table_name)
  }
}
```

```{R}
all_countries
country_regions
global_economic_activity
global_human_day

```

```{R}
nz_activity <- all_countries %>% 
  filter(country_iso3 == "NZL")

```

```{R}
nz_clean <- nz_activity %>%
  mutate(Location = "NZ") %>%
  select(Subcategory,"hoursPerDay"=hoursPerDayCombined,"uncertainty"=uncertaintyCombined,Location) %>%
  mutate(Subcategory = fct_reorder(Subcategory, hoursPerDay)) %>%
  bind_rows(global_economic_activity %>% mutate(Location = "Global"))

ggplot() +
  geom_bar(data = nz_clean, aes(x = Subcategory, y = hoursPerDay, fill = Location, group = Location),
           position=position_dodge(0.8),stat="identity") +
  coord_flip() + 
  theme_minimal() +
  ggtitle("nz_activity")
```